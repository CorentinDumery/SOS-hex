%{
The jacobian determinant of the trilinear map for the hex with given vertices, evaluated at the given points
	V	vertices of hex, 8x3
	p	points to evaluate at, Nx3
returns:
	J	jacobians, Nx1
%}
function J = symbolic_jacobian_det(V, p)
	J = (-((1 - p(:,2)).*V(1,3).*(1 - p(:,3))) + (1 - p(:,2)).*V(2,3).*(1 - p(:,3)) + p(:,2).*V(3,3).*(1 - p(:,3)) - p(:,2).*V(4,3).*(1 - p(:,3)) - (1 - p(:,2)).*V(5,3).*p(:,3) + (1 - p(:,2)).*V(6,3).*p(:,3) + p(:,2).*V(7,3).*p(:,3) - p(:,2).*V(8,3).*p(:,3)).*((-((1 - p(:,1)).*(1 - p(:,2)).*V(1,2)) - p(:,1).*(1 - p(:,2)).*V(2,2) - p(:,1).*p(:,2).*V(3,2) - (1 - p(:,1)).*p(:,2).*V(4,2) + (1 - p(:,1)).*(1 - p(:,2)).*V(5,2) + p(:,1).*(1 - p(:,2)).*V(6,2) + p(:,1).*p(:,2).*V(7,2) + (1 - p(:,1)).*p(:,2).*V(8,2)).*(-((1 - p(:,1)).*V(1,1).*(1 - p(:,3))) - p(:,1).*V(2,1).*(1 - p(:,3)) + p(:,1).*V(3,1).*(1 - p(:,3)) + (1 - p(:,1)).*V(4,1).*(1 - p(:,3)) - (1 - p(:,1)).*V(5,1).*p(:,3) - p(:,1).*V(6,1).*p(:,3) + p(:,1).*V(7,1).*p(:,3) + (1 - p(:,1)).*V(8,1).*p(:,3)) - (-((1 - p(:,1)).*(1 - p(:,2)).*V(1,1)) - p(:,1).*(1 - p(:,2)).*V(2,1) - p(:,1).*p(:,2).*V(3,1) - (1 - p(:,1)).*p(:,2).*V(4,1) + (1 - p(:,1)).*(1 - p(:,2)).*V(5,1) + p(:,1).*(1 - p(:,2)).*V(6,1) + p(:,1).*p(:,2).*V(7,1) + (1 - p(:,1)).*p(:,2).*V(8,1)).*(-((1 - p(:,1)).*V(1,2).*(1 - p(:,3))) - p(:,1).*V(2,2).*(1 - p(:,3)) + p(:,1).*V(3,2).*(1 - p(:,3)) + (1 - p(:,1)).*V(4,2).*(1 - p(:,3)) - (1 - p(:,1)).*V(5,2).*p(:,3) - p(:,1).*V(6,2).*p(:,3) + p(:,1).*V(7,2).*p(:,3) + (1 - p(:,1)).*V(8,2).*p(:,3))) - (-((1 - p(:,1)).*V(1,3).*(1 - p(:,3))) - p(:,1).*V(2,3).*(1 - p(:,3)) + p(:,1).*V(3,3).*(1 - p(:,3)) + (1 - p(:,1)).*V(4,3).*(1 - p(:,3)) - (1 - p(:,1)).*V(5,3).*p(:,3) - p(:,1).*V(6,3).*p(:,3) + p(:,1).*V(7,3).*p(:,3) + (1 - p(:,1)).*V(8,3).*p(:,3)).*((-((1 - p(:,1)).*(1 - p(:,2)).*V(1,2)) - p(:,1).*(1 - p(:,2)).*V(2,2) - p(:,1).*p(:,2).*V(3,2) - (1 - p(:,1)).*p(:,2).*V(4,2) + (1 - p(:,1)).*(1 - p(:,2)).*V(5,2) + p(:,1).*(1 - p(:,2)).*V(6,2) + p(:,1).*p(:,2).*V(7,2) + (1 - p(:,1)).*p(:,2).*V(8,2)).*(-((1 - p(:,2)).*V(1,1).*(1 - p(:,3))) + (1 - p(:,2)).*V(2,1).*(1 - p(:,3)) + p(:,2).*V(3,1).*(1 - p(:,3)) - p(:,2).*V(4,1).*(1 - p(:,3)) - (1 - p(:,2)).*V(5,1).*p(:,3) + (1 - p(:,2)).*V(6,1).*p(:,3) + p(:,2).*V(7,1).*p(:,3) - p(:,2).*V(8,1).*p(:,3)) - (-((1 - p(:,1)).*(1 - p(:,2)).*V(1,1)) - p(:,1).*(1 - p(:,2)).*V(2,1) - p(:,1).*p(:,2).*V(3,1) - (1 - p(:,1)).*p(:,2).*V(4,1) + (1 - p(:,1)).*(1 - p(:,2)).*V(5,1) + p(:,1).*(1 - p(:,2)).*V(6,1) + p(:,1).*p(:,2).*V(7,1) + (1 - p(:,1)).*p(:,2).*V(8,1)).*(-((1 - p(:,2)).*V(1,2).*(1 - p(:,3))) + (1 - p(:,2)).*V(2,2).*(1 - p(:,3)) + p(:,2).*V(3,2).*(1 - p(:,3)) - p(:,2).*V(4,2).*(1 - p(:,3)) - (1 - p(:,2)).*V(5,2).*p(:,3) + (1 - p(:,2)).*V(6,2).*p(:,3) + p(:,2).*V(7,2).*p(:,3) - p(:,2).*V(8,2).*p(:,3))) + (-((1 - p(:,1)).*(1 - p(:,2)).*V(1,3)) - p(:,1).*(1 - p(:,2)).*V(2,3) - p(:,1).*p(:,2).*V(3,3) - (1 - p(:,1)).*p(:,2).*V(4,3) + (1 - p(:,1)).*(1 - p(:,2)).*V(5,3) + p(:,1).*(1 - p(:,2)).*V(6,3) + p(:,1).*p(:,2).*V(7,3) + (1 - p(:,1)).*p(:,2).*V(8,3)).*((-((1 - p(:,2)).*V(1,1).*(1 - p(:,3))) + (1 - p(:,2)).*V(2,1).*(1 - p(:,3)) + p(:,2).*V(3,1).*(1 - p(:,3)) - p(:,2).*V(4,1).*(1 - p(:,3)) - (1 - p(:,2)).*V(5,1).*p(:,3) + (1 - p(:,2)).*V(6,1).*p(:,3) + p(:,2).*V(7,1).*p(:,3) - p(:,2).*V(8,1).*p(:,3)).*(-((1 - p(:,1)).*V(1,2).*(1 - p(:,3))) - p(:,1).*V(2,2).*(1 - p(:,3)) + p(:,1).*V(3,2).*(1 - p(:,3)) + (1 - p(:,1)).*V(4,2).*(1 - p(:,3)) - (1 - p(:,1)).*V(5,2).*p(:,3) - p(:,1).*V(6,2).*p(:,3) + p(:,1).*V(7,2).*p(:,3) + (1 - p(:,1)).*V(8,2).*p(:,3)) - (-((1 - p(:,1)).*V(1,1).*(1 - p(:,3))) - p(:,1).*V(2,1).*(1 - p(:,3)) + p(:,1).*V(3,1).*(1 - p(:,3)) + (1 - p(:,1)).*V(4,1).*(1 - p(:,3)) - (1 - p(:,1)).*V(5,1).*p(:,3) - p(:,1).*V(6,1).*p(:,3) + p(:,1).*V(7,1).*p(:,3) + (1 - p(:,1)).*V(8,1).*p(:,3)).*(-((1 - p(:,2)).*V(1,2).*(1 - p(:,3))) + (1 - p(:,2)).*V(2,2).*(1 - p(:,3)) + p(:,2).*V(3,2).*(1 - p(:,3)) - p(:,2).*V(4,2).*(1 - p(:,3)) - (1 - p(:,2)).*V(5,2).*p(:,3) + (1 - p(:,2)).*V(6,2).*p(:,3) + p(:,2).*V(7,2).*p(:,3) - p(:,2).*V(8,2).*p(:,3)));
end